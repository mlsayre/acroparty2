{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"meteor/mongo","imported":["Mongo"],"specifiers":[{"kind":"named","imported":"Mongo","local":"Mongo"}]},{"source":"meteor/check","imported":["check"],"specifiers":[{"kind":"named","imported":"check","local":"check"}]},{"source":"../api/rooms.js","imported":["Rooms"],"specifiers":[{"kind":"named","imported":"Rooms","local":"Rooms"}]},{"source":"../api/games.js","imported":["Games"],"specifiers":[{"kind":"named","imported":"Games","local":"Games"}]}],"exports":{"exported":["Gamedata"],"specifiers":[{"kind":"local","local":"Gamedata","exported":"Gamedata"}]}}},"options":{"filename":"/imports/api/gamedata.js","filenameRelative":"/imports/api/gamedata.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/imports/api/gamedata.js.map","sourceFileName":"/imports/api/gamedata.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"gamedata"},"ignored":false,"code":"module.export({Gamedata:function(){return Gamedata}});var Meteor;module.import('meteor/meteor',{\"Meteor\":function(v){Meteor=v}});var Mongo;module.import('meteor/mongo',{\"Mongo\":function(v){Mongo=v}});var check;module.import('meteor/check',{\"check\":function(v){check=v}});var Rooms;module.import('../api/rooms.js',{\"Rooms\":function(v){Rooms=v}});var Games;module.import('../api/games.js',{\"Games\":function(v){Games=v}});\n\n\n\n\n\nvar Gamedata = new Mongo.Collection('gamedata');\n\nif (Meteor.isServer) {\n  Meteor.publish('gamedata', function () {\n    function tasksPublication() {\n      return Gamedata.find();\n    }\n\n    return tasksPublication;\n  }());\n}\n\nMeteor.methods({\n  'gamedata.postAnswer': function () {\n    function gamedataPostAnswer(roomId, userId, answer) {\n      var submitAnswerTime = new Date();\n      Gamedata.update({ room_id: roomId, user_id: userId }, {\n        $set: { answer: answer,\n          submitAnswerTime: submitAnswerTime }\n      });\n      var countStarted = Games.findOne({ room_id: roomId }).playStartTime;\n      var finalSubmitTime = (submitAnswerTime - countStarted) / 1000;\n      Gamedata.update({ room_id: roomId, user_id: userId }, {\n        $set: { finalAnswerTime: finalSubmitTime }\n      });\n    }\n\n    return gamedataPostAnswer;\n  }()\n});","ast":null,"map":{"version":3,"sources":["/imports/api/gamedata.js"],"names":[],"mappings":"AAAA,SAAS,MAAT,QAAuB,eAAvB;AACA,SAAS,KAAT,QAAsB,cAAtB;AACA,SAAS,KAAT,QAAsB,cAAtB;;AAEA,SAAS,KAAT,QAAsB,iBAAtB;AACA,SAAS,KAAT,QAAsB,iBAAtB;AACA,OAAO,IAAM,WAAW,IAAI,MAAM,UAAV,CAAqB,UAArB,CAAjB;;AAEP,IAAI,OAAO,QAAX,EAAqB;AACnB,SAAO,OAAP,CAAe,UAAf;AAA2B,aAAS,gBAAT,GAA4B;AACrD,aAAO,SAAS,IAAT,EAAP;AACD;;AAFD,WAAoC,gBAApC;AAAA;AAGD;;AAED,OAAO,OAAP,CAAe;AACb,uBADa;AAAA,gCACS,MADT,EACiB,MADjB,EACyB,MADzB,EACiC;AAC5C,UAAI,mBAAmB,IAAI,IAAJ,EAAvB;AACA,eAAS,MAAT,CAAgB,EAAC,SAAS,MAAV,EAAkB,SAAS,MAA3B,EAAhB,EAAoD;AAClD,cAAM,EAAE,QAAQ,MAAV;AACE,4BAAkB,gBADpB;AAD4C,OAApD;AAIA,UAAI,eAAe,MAAM,OAAN,CAAc,EAAC,SAAS,MAAV,EAAd,EAAiC,aAApD;AACA,UAAI,kBAAkB,CAAC,mBAAmB,YAApB,IAAoC,IAA1D;AACA,eAAS,MAAT,CAAgB,EAAC,SAAS,MAAV,EAAkB,SAAS,MAA3B,EAAhB,EAAoD;AAClD,cAAM,EAAE,iBAAiB,eAAnB;AAD4C,OAApD;AAGD;;AAZY;AAAA;AAAA,CAAf","file":"/imports/api/gamedata.js.map","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Mongo } from 'meteor/mongo';\nimport { check } from 'meteor/check';\n\nimport { Rooms } from '../api/rooms.js';\nimport { Games } from '../api/games.js';\nexport const Gamedata = new Mongo.Collection('gamedata');\n\nif (Meteor.isServer) {\n  Meteor.publish('gamedata', function tasksPublication() {\n    return Gamedata.find();\n  });\n}\n\nMeteor.methods({\n  'gamedata.postAnswer'(roomId, userId, answer) {\n    var submitAnswerTime = new Date();\n    Gamedata.update({room_id: roomId, user_id: userId}, {\n      $set: { answer: answer,\n              submitAnswerTime: submitAnswerTime },\n    });\n    var countStarted = Games.findOne({room_id: roomId}).playStartTime\n    var finalSubmitTime = (submitAnswerTime - countStarted) / 1000;\n    Gamedata.update({room_id: roomId, user_id: userId}, {\n      $set: { finalAnswerTime: finalSubmitTime },\n    });\n  },\n\n  // 'rooms.removePlayer'(roomId, playerRemoving) {\n  //   Rooms.update(roomId, {\n  //     $pull: { players:  playerRemoving\n  //   }}, {multi: true})\n  // }\n\n})\n"]},"hash":"47b9b312463969f882a82951188256fa6e231a0b"}
